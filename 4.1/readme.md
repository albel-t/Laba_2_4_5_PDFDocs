### 8. Графики заряда АКБ

#### Исходные данные

Имеется лог-файл, полученный с "умного" зарядного устройства.
Данные в файле хранятся в формате `TSV` (значения разделены)
друг от друга пробелами или табуляцией (может быть один или более
разделительных символов подряд) и разделены на секции, каждая секция
начинается со строки заголовка, которая имеет следующий формат:

```text
==Section Title==
```

---

Файл может содержать следующие секции:

* `Items` - содержит значения параметров тестирования: 
  * секция содержит одну или более строк с данными;
  * параметры в строке отделены друг от друга пробелами или табуляцией;
  * каждый параметр записан в формате `Key:ValueUnits`, где `Key` - название параметра, `Value` - его значение, `Units` - единица измерения. Параметры могут быть числовые и текстовые, единицы измерения указываются только для числовых параметров;
* `Data` - основная секция с записью процесса тестирования: 
  * содержит строку заголовка и одну или более строк с данными;
  * параметры в строке отделены друг от друга пробелами или табуляцией;
  * время в секции данных записывается без ведущих нулей (`0:0:5` вместо `00:00:05`);
  * интервал между записями может быть от 1 до 60 секунд, при этом внутри одного файла интервал не меняется (данные внутри одного файла записываются с постоянной частотой);
  * секция содержит данные об одном или нескольких циклах заряда-разряда АКБ. Какие-либо специальные разделители между записями относящимися к разным циклам отсутствуют. Начало цикла можно определить по значению времени, в начале каждого цикла время сбрасывается (цикл всегда начинается с отметки времени `0:0:0`). Также можно ориентироваться на значение параметра `Cyc` из секции `Items`, если он в ней присутствует. Однако фактических данных может быть меньше, чем указано в `Cyc`, например если процесс тестирования прерван пользователем;
  * между концом одного цикла и началом следующего могут быть промежутки времени, в течение которых ничего не происходит (состояние покоя). Тем не менее во время состояния покоя данные всё равно записываются в лог. Время в таких промежутках может начинаться не с нуля, а с любой произвольной отметки, например с `0:0:45` или с `0:35:11`. Время в момент начала состояния покоя может быть как меньше, так и больше времени в момент окончания предшествующего рабочего цикла (это баг в прошивке устройства), но при этом всегда присутствует резкий перепад на шкале времени, либо положительный, либо отрицательный;
* `End` - содержит итоговые данные тестирования: 
  * структура секции в целом повторяет секцию `Items`;
  * параметр `IntRes` (внутреннее сопротивление ячеек) содержит несколько значений, разделённых табуляцией или пробелами, этот параметр занимает строку целиком (кроме него в строке не может быть других параметров);
* `Error` - содержит информацию о возникших ошибках: 
  * секция содержит одну или более строк с текстом ошибок.

---

Секция данных содержит следующие столбцы:

* `Time` (h/m/s) - отметка времени
* `Vin` (mv) - напряжение на входе *в милливольтах*
* `Iin` (mA) - ток на входе *в миллиамперах*
* `Power-in` (W) - мощность на входе *в ваттах*
* `Vout` (mv) - напряжение на батарее *в милливольтах*
* `Iout` (mA) - ток заряда/разряда батареи *в миллиамперах*
* `Power-ch` (W) - мощность заряда/разряда батареи *в ваттах*
* `Capa` (mah) - полученная или отданная ёмкость *в миллиампер-часах*
* `inTmp` (C) - температура зарядного устройства *в градусах Цельсия*
* `exttmp` (C) - температура батареи *в градусах Цельсия*
* `B1` - `B8` (mv) - напряжение на ячейках батареи *в милливольтах*

Полным циклом заряда (разряда) считается такой цикл, в начале и конце
которого напряжение на батарее равно соответственно минимальному
(максимальному) и максимальному (минимальному) напряжению с погрешностью
не более 10% на момент начала и не более 2% на момент окончания цикла.

Минимальное (максимальное) напряжение батареи рассчитывается как
произведение минимального `DV` (максимального `CV`) напряжения на
одной ячейке и количества ячеек `Cells` в батарее (значения из секции
`Items`).

### Результат работы программы

Необходимо написать программу, которая анализирует содержимое файла
и генерирует отчёт в формате `PDF`, содержащий следующую информацию (за каждый маркер верхнего уровня даётся 0.5 балла. За реализацию всех маркеров в одной программе +2 балла на усмотрение преподавателя):

* значения всех параметров из секции `Items`, вывести в таблицу, состоящую из 4-х столбцов: параметр, значение, параметр, значение. Для числовых параметров необходимо вставить пробел между значением и единицей измерения;
* значения, полученные в результате тестирования (для параметров, отмеченных (*), необходимо рассчитать среднее значение и разброс в %, если файл содержит более одного цикла заряда или разряда соответственно): 
  * (*) разрядную (`CapDsc`) и зарядную (`CapChg`) ёмкость батареи в миллиампер-часах (`mAh`);
  * (*) разрядную (`EneDsc`) и зарядную (`EneChg`) энергию батареи в милливатт-часах (`mWh`);
  * (*) продолжительность одного **полного** цикла заряда (`TimeChg`)
  * суммарное фактическое количество циклов заряда (`CycChg`) и суммарное количество **полных** циклов заряда (`CycChgFull`)
  * (*) продолжительность одного **полного** цикла разряда (`TimeDsc`)
  * суммарное фактическое количество циклов разряда (`CycDsc`) и суммарное количество **полных** циклов разряда (`CycDscFull`)
  * общую продолжительность тестирования (`TimeTotal`)
* Информацию по каждому циклу заряда/разряда АКБ: 
  * отдельный набор графиков для каждого цикла разряда и заряда: 
    * график зависимости напряжения на батарее *в вольтах* (левая шкала Y) и тока батареи *в амперах* (правая шкала Y) от времени, для тока брать значение по модулю;
    * график зависимости модуля мощности на батарее *в ваттах* от времени. Значение мощности вычислять из значений тока и напряжения, так как значения мощности из файла имеют слишком низкое разрешение;
    * график зависимости ёмкости *в ампер-часах* (левая шкала Y) и энергии *в ватт-часах* (правая шкала Y) полученной с батареи от времени. Энергию рассчитывать как интеграл мощности по времени, при этом значение мощности брать из предыдущего этапа, а не из файла;
    * график зависимости температуры батареи *в градусах Цельсия* от времени. Выводится только в том случае, если температура на протяжении цикла поднималась выше нуля (отрицательная температура означает что внешний термодатчик не подключен);
    * график зависимости напряжения *в вольтах* на каждой ячейке батареи от времени (один общий график на все ячейки). Выводится только в случае, если во время цикла зафиксированы значения больше нуля хотя бы для одной из ячеек.
  * сводную таблицу со значениями следующих параметров цикла: 
    * продолжительность цикла
    * начальное напряжение на батарее *в вольтах*
    * конечное напряжение на батарее *в вольтах*
    * общую принятую (отданную) ёмкость *в ампер-часах*
    * общую принятую (отданную) энергию *в ватт-часах*
* общие графики за всё время тестирования (шкалу времени необходимо нормализовать и устранить все разрывы. Принять за допущение, что время между окончанием рабочего цикла и началом состояния покоя равно времени интервала между соседними записями для данного файла): 
  * график зависимости напряжения на батарее *в вольтах* (левая шкала Y) и тока батареи *в амперах* (правая шкала Y) от времени, для тока брать абсолютное значение;
  * график зависимости мощности на батарее *в ваттах* от времени. Значение мощности вычислять из значений тока и напряжения, так как значения мощности из файла имеют слишком низкое разрешение;
  * график зависимости ёмкости *в ампер-часах* (левая шкала Y) и энергии *в ватт-часах* (правая шкала Y) полученной с батареи от времени. Энергию рассчитывать как интеграл мощности по времени, при этом значение мощности брать из предыдущего этапа, а не из файла;
  * график зависимости напряжения *в вольтах* на каждой ячейке батареи от времени (один общий график на все ячейки). Выводится только в случае, если во время цикла зафиксированы значения больше нуля хотя бы для одной из ячеек;
  * график зависимости температуры батареи *в градусах Цельсия* и внутренней температуры зарядного устройства *в градусах Цельсия* от времени. Температура батареи выводится только в том случае, если на протяжении тестирования она поднималась выше нуля;
  * график зависимости напряжения на входе *в вольтах* (левая шкала Y) и тока на входе *в амперах* (правая шкала Y) от времени.
  * график зависимости мощности на входе *в ваттах* от времени. Значение мощности вычислять из значений тока и напряжения, так как значения мощности из файла имеют слишком низкое разрешение;